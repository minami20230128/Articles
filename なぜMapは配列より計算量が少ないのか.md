# なぜMapは配列より計算量が少ないのか
## 調べようと思ったきっかけ
業務でパフォーマンスチューニングを行った際、配列からfilterで線形探索を行うよりも予めMapを作成しておいたほうが計算量が減ることを知った。  
しかし、Mapであっても結局全要素の中から指定したキーを探さなければならないはず。なぜ計算量がO(1)になるのだろう？と気になったため。

## 結論
Mapはキーのハッシュ値でバリューを管理しているので、キーを指定するとハッシュ関数を通して（ほぼ）一発で目的の要素を求めることができるから。  

## Mapの仕組み
**ハッシュテーブル**（キーのハッシュ値を添え字とした配列）というデータ構造を使っている。  

![ハッシュテーブル](/images/ハッシュテーブル.png)
出典：https://codezine.jp/article/detail/6396  

Mapに新しい要素を登録すると、キーをハッシュ関数に通し、求まったハッシュ値の位置に新要素を格納する。  
Map.get()を実行して特定の要素を取得するときも同じハッシュ関数を使って求めたハッシュ値で探す。  
ただし、**異なるキー同士のハッシュ値が重複する場合も可能性**もゼロではない。この場合は同じハッシュ値の全要素の中からキーが一致するものを線形探索する。  
O(1)というのはあくまで平均であり、基本的には一発で求まるが必ずしもそうではない。