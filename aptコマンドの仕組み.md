# aptコマンドの仕組み
APT(Advanced Package Tool)とは、Ubuntu・Debianにおけるパッケージ管理の仕組み。  

## 代表的なコマンド
リポジトリが保有しているパッケージのリストを取得する。
```
sudo apt update
```
パッケージをインストールする。
```
sudo apt install [パッケージ名]
```

## APTリポジトリ
パッケージをインストールしてくるときは、**APTリポジトリ**というパッケージが置かれているサーバから取得してくる。  
ハッキングなどを受けてニセのソフトウェアをインストールさせられることを防止するため、APTリポジトリはOpenPGP形式の公開鍵で署名されている。  
そのため、aptコマンド使用時にはOpenPGP形式の公開鍵を使っての認証が必要になる。  
この公開鍵の場所など、APYTリポジトリとの通信に必要な情報が書かれているのが「リポジトリ情報ファイル」であり、それぞれ下記のディレクトリに置かれている。
- 公式リポジトリ.../etc/apt/sources.list
- 非公式リポジトリ.../etc/apt/sources.list.d  
鍵を新たにインストールした場合や、場所を移動させた場合はこのファイルの編集が必要になる。  

## aptとapt-getの違い
どちらもAPTを基盤にしているが、  
aptは人間が対話的に使いやすいように作られた比較的新しいコマンドラインツール。  
apt-getはaptの改良前のものであり、現在では自動化・スクリプト用にしか使われていない。  
Dockerfileではapt-getを使用することが推奨される。   

## apt-keyについて  
新たな公開鍵を追加するときは、もともと
```
apt-key add
```
というコマンドを使用して/etc/apt/trusted.gpgという単一ファイルに公開鍵を追加していた。  
しかし、このコマンドを使用して追加された鍵は、全てのリポジトリの認証に対して使用されてしまう。  
また、単一ファイルで管理しているため壊れやすい。  
そのため、apt-keyは廃止されることになり、  
公開鍵はそれぞれバラバラのファイルとして/etc/apt/keyringsに保存する形式となった。